import{a as F}from"./chunk-SRH65J3K.js";import{A as c,B as I,C as N,Ca as Q,D as f,F as q,J as s,K as _,Q as b,R as D,S as U,T as A,U as V,aa as j,ba as M,ca as v,da as R,ea as O,h as g,ha as B,j as C,ja as G,ka as P,l as h,m as E,n as S,o as y,qa as $,s as o,sa as z,t as u,u as l,ua as H,v as a,va as J,wa as K,xa as w,y as r,z as n,za as L}from"./chunk-YTAQRA7X.js";var X=(()=>{let t=class t{};t.\u0275fac=function(d){return new(d||t)},t.\u0275cmp=h({type:t,selectors:[["ng-component"]],decls:3,vars:0,consts:[[1,"p-4"],[1,"container"]],template:function(d,p){d&1&&(r(0,"div",0)(1,"div",1),c(2,"router-outlet"),n()())},dependencies:[J],encapsulation:2});let e=t;return e})();function re(e,t){e&1&&c(0,"span",10)}function oe(e,t){e&1&&(r(0,"span"),s(1,"Delete"),n())}function ae(e,t){if(e&1){let i=I();r(0,"tr")(1,"td"),s(2),n(),r(3,"td"),s(4),n(),r(5,"td"),s(6),n(),r(7,"td"),s(8),n(),r(9,"td",6)(10,"a",7),s(11,"Edit"),n(),r(12,"button",8),N("click",function(){let d=S(i).$implicit,p=f();return y(p.deleteUser(d.username))}),l(13,re,1,0,"span",9)(14,oe,2,0,"span",5),n()()()}if(e&2){let i=t.$implicit,m=f();o(2),_(i.firstName),o(2),_(i.lastName),o(2),_(i.email),o(2),_(i.username),o(2),q("routerLink","edit/",i.username,""),o(2),a("disabled",i.isDeleting),o(),a("ngIf",m.isDeleting),o(),a("ngIf",!m.isDeleting)}}function se(e,t){e&1&&(r(0,"tr")(1,"td",11),c(2,"span",12),n()())}var Y=(()=>{let t=class t{constructor(m){this.accountService=m,this.isDeleting=!1}ngOnInit(){this.accountService.getAll().pipe(g()).subscribe(m=>{this.users=m})}deleteUser(m){if(confirm("Are you sure to delete ")){let d=this.users.find(p=>p.username===m);this.isDeleting=!0,console.log("going to call service to delete observatiobn id=",m),this.accountService.delete(m).pipe(g()).subscribe(()=>{this.users=this.users.filter(p=>p.username!==m),this.isDeleting=!1})}}};t.\u0275fac=function(d){return new(d||t)(u(F))},t.\u0275cmp=h({type:t,selectors:[["ng-component"]],decls:19,vars:2,consts:[["routerLink","add",1,"btn","btn-sm","btn-success","mb-2"],[1,"table","table-striped"],[2,"width","30%"],[2,"width","10%"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"white-space","nowrap"],[1,"btn","btn-sm","btn-primary","me-1",3,"routerLink"],[1,"btn","btn-sm","btn-danger","btn-delete-user",3,"click","disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"spinner-border","spinner-border-sm"],["colspan","4",1,"text-center"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(d,p){d&1&&(r(0,"h1"),s(1,"Users"),n(),r(2,"a",0),s(3,"Add User"),n(),r(4,"table",1)(5,"thead")(6,"tr")(7,"th",2),s(8,"First Name"),n(),r(9,"th",2),s(10,"Last Name"),n(),r(11,"th",2),s(12,"E-mail"),n(),r(13,"th",2),s(14,"Username"),n(),c(15,"th",3),n()(),r(16,"tbody"),l(17,ae,15,9,"tr",4)(18,se,3,0,"tr",5),n()()),d&2&&(o(17),a("ngForOf",p.users),o(),a("ngIf",!p.users))},dependencies:[U,A,w],encapsulation:2});let e=t;return e})();var x=e=>({"is-invalid":e});function me(e,t){e&1&&(r(0,"div"),s(1,"First Name is required"),n())}function de(e,t){if(e&1&&(r(0,"div",18),l(1,me,2,0,"div",11),n()),e&2){let i=f(2);o(),a("ngIf",i.f.firstName.errors.required)}}function le(e,t){e&1&&(r(0,"div"),s(1,"Last Name is required"),n())}function pe(e,t){if(e&1&&(r(0,"div",18),l(1,le,2,0,"div",11),n()),e&2){let i=f(2);o(),a("ngIf",i.f.lastName.errors.required)}}function ce(e,t){e&1&&(r(0,"div"),s(1,"Email is required"),n())}function fe(e,t){if(e&1&&(r(0,"div",18),l(1,ce,2,0,"div",11),n()),e&2){let i=f(2);o(),a("ngIf",i.f.email.errors.required)}}function ue(e,t){e&1&&(r(0,"div"),s(1,"Username is required"),n())}function ve(e,t){if(e&1&&(r(0,"div",18),l(1,ue,2,0,"div",11),n()),e&2){let i=f(2);o(),a("ngIf",i.f.username.errors.required)}}function _e(e,t){e&1&&(r(0,"em"),s(1,"(Leave blank to keep the same password)"),n())}function ge(e,t){e&1&&(r(0,"div"),s(1,"Password is required"),n())}function he(e,t){e&1&&(r(0,"div"),s(1,"Password must be at least 6 characters"),n())}function be(e,t){if(e&1&&(r(0,"div",18),l(1,ge,2,0,"div",11)(2,he,2,0,"div",11),n()),e&2){let i=f(2);o(),a("ngIf",i.f.password.errors.required),o(),a("ngIf",i.f.password.errors.minlength)}}function xe(e,t){e&1&&(r(0,"div",19)(1,"div",3)(2,"div",4),c(3,"input",20),s(4," Admin User "),n()()())}function Ce(e,t){e&1&&c(0,"span",21)}function Ee(e,t){if(e&1){let i=I();r(0,"form",2),N("ngSubmit",function(){S(i);let d=f();return y(d.onSubmit())}),r(1,"div",3)(2,"div",4)(3,"label",5),s(4,"First Name"),n(),c(5,"input",6),l(6,de,2,1,"div",7),n(),r(7,"div",4)(8,"label",5),s(9,"Last Name"),n(),c(10,"input",8),l(11,pe,2,1,"div",7),n(),r(12,"div",4)(13,"label",5),s(14,"E-mail"),n(),c(15,"input",9),l(16,fe,2,1,"div",7),n()(),r(17,"div",3)(18,"div",4)(19,"label",5),s(20,"Username"),n(),c(21,"input",10),l(22,ve,2,1,"div",7),n(),r(23,"div",4)(24,"label",5),s(25," Password "),l(26,_e,2,0,"em",11),n(),c(27,"input",12),l(28,be,3,2,"div",7),n()(),l(29,xe,5,0,"div",13),r(30,"div",14)(31,"button",15),l(32,Ce,1,0,"span",16),s(33," Save "),n(),r(34,"a",17),s(35,"Cancel"),n()()()}if(e&2){let i=f();a("formGroup",i.form),o(5),a("ngClass",b(15,x,i.submitted&&i.f.firstName.errors)),o(),a("ngIf",i.submitted&&i.f.firstName.errors),o(4),a("ngClass",b(17,x,i.submitted&&i.f.lastName.errors)),o(),a("ngIf",i.submitted&&i.f.lastName.errors),o(4),a("ngClass",b(19,x,i.submitted&&i.f.email.errors)),o(),a("ngIf",i.submitted&&i.f.email.errors),o(5),a("ngClass",b(21,x,i.submitted&&i.f.username.errors)),o(),a("ngIf",i.submitted&&i.f.username.errors),o(4),a("ngIf",i.username),o(),a("ngClass",b(23,x,i.submitted&&i.f.password.errors)),o(),a("ngIf",i.submitted&&i.f.password.errors),o(),a("ngIf",i.showAdminUserFlag),o(2),a("disabled",i.submitting),o(),a("ngIf",i.submitting)}}function Se(e,t){e&1&&(r(0,"div",22),c(1,"span",23),n())}var k=(()=>{let t=class t{constructor(m,d,p,ee,te){this.formBuilder=m,this.route=d,this.router=p,this.accountService=ee,this.alertService=te,this.loading=!1,this.submitting=!1,this.submitted=!1,this.showAdminUserFlag=!1}ngOnInit(){this.username=this.route.snapshot.params.username,this.form=this.formBuilder.group({firstName:["",v.required],lastName:["",v.required],email:["",v.required],username:["",v.required],admin_user_flag:[!1,v.required],password:["",[v.minLength(6),...this.username?[]:[v.required]]]}),this.title="Add User",this.username&&(this.title="Edit User",this.showAdminUserFlag=!1,this.loading=!0,this.accountService.getById(this.username).pipe(g()).subscribe(m=>{console.log("getbyid for edit user:",m),this.form.patchValue(m),this.loading=!1,console.log("getbyid for edit user - admin user:",this.accountService.userValue?.admin_user_flag),this.accountService.userValue?.admin_user_flag&&(this.showAdminUserFlag=!0)}))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.submitting=!0,this.saveUser().pipe(g()).subscribe({next:()=>{this.alertService.success("User saved",{keepAfterRouteChange:!0}),this.router.navigateByUrl("/users")},error:m=>{this.alertService.error(m),this.submitting=!1}}))}saveUser(){return this.username?this.accountService.update(this.form.value):this.accountService.register(this.form.value)}};t.\u0275fac=function(d){return new(d||t)(u($),u(H),u(K),u(F),u(Q))},t.\u0275cmp=h({type:t,selectors:[["ng-component"]],decls:4,vars:3,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center m-5",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"mb-3","col"],[1,"form-label"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],["type","email","formControlName","email",1,"form-control",3,"ngClass"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],[4,"ngIf"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],["class","container",4,"ngIf"],[1,"mb-3"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["routerLink","/users",1,"btn","btn-link"],[1,"invalid-feedback"],[1,"container"],["type","checkbox","formControlName","admin_user_flag","id","admin_user_flag","aria-describedby","basic-addon5"],[1,"spinner-border","spinner-border-sm","me-1"],[1,"text-center","m-5"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(d,p){d&1&&(r(0,"h1"),s(1),n(),l(2,Ee,36,25,"form",0)(3,Se,2,0,"div",1)),d&2&&(o(),_(p.title),o(),a("ngIf",!p.loading),o(),a("ngIf",p.loading))},dependencies:[D,A,B,M,j,R,O,G,P,w],encapsulation:2});let e=t;return e})();var ye=[{path:"",component:X,children:[{path:"",component:Y},{path:"add",component:k},{path:"edit/:username",component:k}]}],Z=(()=>{let t=class t{};t.\u0275fac=function(d){return new(d||t)},t.\u0275mod=E({type:t}),t.\u0275inj=C({imports:[L.forChild(ye),L]});let e=t;return e})();var Je=(()=>{let t=class t{};t.\u0275fac=function(d){return new(d||t)},t.\u0275mod=E({type:t}),t.\u0275inj=C({imports:[V,z,Z]});let e=t;return e})();export{Je as UsersModule};
